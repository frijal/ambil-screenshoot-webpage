<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Pengecekan & Laporan Konten Harian â€” GitHub Actions ğŸ”†</title>
  <meta name="description" content="Workflow GitHub Actions untuk otomatis membersihkan gambar orphan dan membuat laporan konten harian di dalam.web.id. Dilengkapi penjelasan lengkap dan kode siap pakai." />
  <link rel="canonical" href="https://dalam.web.id/artikel/pengecekan-laporan-konten-harian.html" />
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <!-- Open Graph -->
  <meta property="og:type" content="article" />
  <meta property="og:title" content="ğŸ”† Pengecekan & Laporan Konten Harian â€” GitHub Actions" />
  <meta property="og:description" content="Workflow GitHub Actions otomatis untuk pembersihan gambar orphan & laporan konten harian." />
  <meta property="og:url" content="https://dalam.web.id/artikel/pengecekan-laporan-konten-harian.html" />
  <meta property="og:image" content="https://dalam.web.id/img/pengecekan-laporan-konten-harian.webp" />
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="ğŸ”† Pengecekan & Laporan Konten Harian â€” GitHub Actions" />
  <meta name="twitter:description" content="Workflow GitHub Actions otomatis untuk membersihkan gambar orphan dan membuat laporan konten." />
  <meta name="twitter:image" content="https://dalam.web.id/img/pengecekan-laporan-konten-harian.webp" />
  <style>
    body {
      font-family: "Segoe UI", Roboto, sans-serif;
      line-height: 1.7;
      margin: 0;
      background: #f9fafb;
      color: #222;
    }
    header {
      background: linear-gradient(135deg, #2b5876, #4e4376);
      color: white;
      text-align: center;
      padding: 3rem 1rem;
    }
    header h1 {
      font-size: 2.2rem;
      margin-bottom: .3rem;
    }
    main {
      max-width: 1080px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 14px;
      box-shadow: 0 3px 15px rgba(0,0,0,0.1);
    }
    h2 {
      border-left: 5px solid #4e4376;
      padding-left: .5rem;
      margin-top: 2rem;
      color: #333;
    }
    code, pre {
      font-family: "Fira Code", monospace;
    }
    pre {
      background: #1e1e1e;
      color: #eaeaea;
      padding: 1rem;
      overflow-x: auto;
      border-radius: 10px;
    }
    .badge {
      background: #4e4376;
      color: white;
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: .85rem;
      margin-right: .5rem;
    }
    .highlight {
      background: #f1f5f9;
      border-left: 4px solid #4e4376;
      padding: .8rem 1rem;
      border-radius: 8px;
    }
    footer {
      text-align: center;
      padding: 2rem;
      color: #666;
      font-size: .9rem;
    }
    .share {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 2rem;
    }
    .share a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: #e0e7ff;
      transition: background .2s;
    }
    .share a:hover {
      background: #c7d2fe;
    }
    .share img {
      width: 24px;
      height: 24px;
    }
    @media (max-width: 700px) {
      main { margin: 1rem; padding: 1.2rem; }
      header h1 { font-size: 1.7rem; }
    }
  </style>
<meta property="og:image:alt" content="Pengecekan & Laporan Konten Harian â€” GitHub Actions ğŸ”†">
  <meta itemprop="image" content="https://dalam.web.id/img/pengecekan-laporan-konten-harian.webp">
<link rel="stylesheet" href="/ext/marquee-url.css"><link rel="alternate" type="application/rss+xml" title="30 artikel baru bikin." href="https://dalam.web.id/rss.xml" />
    <meta property="article:published_time" content="2025-10-22T11:53:56.642+00:00">
<meta name="google-adsense-account" content="ca-pub-8157928740123992"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8157928740123992" crossorigin="anonymous"></script></head>
<body>
  <header>
    <h1>ğŸ”† Pengecekan & Laporan Konten Harian</h1>
<div id="iposbrowser"></div>
    <p>Workflow otomatis untuk menjaga kebersihan folder dan memantau jumlah konten harian di GitHub Pages.</p>
  </header>
  <main>
    <p>Workflow ini dibuat supaya <strong>repo tetap rapi</strong> dan <strong>laporan konten selalu up to date</strong>. Ia berjalan otomatis setiap hari jam 21:00 UTC (atau sekitar jam 04:00 WIB) dan juga bisa dijalankan manual lewat tombol di GitHub Actions.</p>
    <h2>ğŸ¯ Tujuan Workflow</h2>
    <ul>
      <li>ğŸ§¹ Membersihkan file gambar <em>orphan</em> (.webp) yang tidak memiliki artikel HTML pasangannya.</li>
      <li>ğŸ§¾ Menghitung jumlah artikel, cover, dan total file dalam folder <code>artikel</code> &amp; <code>img</code>.</li>
      <li>ğŸ“Š Membuat laporan harian dalam bentuk file teks &amp; badge JSON.</li>
    </ul>
    <h2>ğŸ§© Job 1: Cleanup Gambar Orphan</h2>
    <div class="highlight">
      Job pertama akan memindai semua file <code>.webp</code> di folder <code>img/</code>. Jika tidak ditemukan file HTML dengan nama yang sama di folder <code>artikel/</code>, maka file gambar tersebut dianggap yatim dan akan dihapus menggunakan perintah <code>git rm</code>.
    </div>
    <pre><code>for webp_file in img/*.webp; do
  base_name=$(basename "$webp_file" .webp)
  html_file="artikel/${base_name}.html"
  if [ ! -f "$html_file" ]; then
    git rm -f "$webp_file"
  fi
done</code></pre>
    <h2>ğŸ“Š Job 2: Laporan & Badge</h2>
    <p>Setelah pembersihan, workflow akan menghitung file berdasarkan ekstensi (<code>html</code>, <code>webp</code>, <code>png</code>), membuat file laporan, serta membuat tiga badge:</p>
    <ul>
      <li><span class="badge">artikel</span> Jumlah file HTML</li>
      <li><span class="badge">cover</span> Jumlah file WebP</li>
      <li><span class="badge">html/webp</span> Perbandingan total keduanya</li>
    </ul>
    <h2>ğŸ“œ Contoh Laporan Harian</h2>
    <pre><code>LAPORAN KONTEN: artikel & img (10-22)
=================================
Total File: 104
HTML=53, webp=48, PNG=3
Ringkasan per ekstensi:
     53 html
     48 webp
      3 png
URL File HTML (dari folder 'artikel'):
https://dalam.web.id/artikel/nama-artikel.html
...</code></pre>
    <h2>âš™ï¸ Kode Workflow Lengkap</h2>
    <p>Berikut adalah isi file workflow <code>.github/workflows/laporan-konten.yml</code> yang siap digunakan:</p>
    <pre><code>name: ğŸ”† Pengecekan & Laporan Konten Harian
on:
  schedule:
    - cron: '0 21 * * *'
  workflow_dispatch:
jobs:
  cleanup:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Cari dan Hapus Gambar Orphan
        id: cleanup_step
        run: |
          echo "ğŸ§¹ Memulai proses pembersihan gambar orphan..."
          DELETED_COUNT=0
          mkdir -p img
          shopt -s nullglob
          for webp_file in img/*.webp; do
            base_name=$(basename "$webp_file" .webp)
            html_file="artikel/${base_name}.html"
            if [ ! -f "$html_file" ]; then
              echo "-> Orphan: '$webp_file' tidak memiliki artikel. Menghapus..."
              git rm -f "$webp_file"
              DELETED_COUNT=$((DELETED_COUNT + 1))
            fi
          done
          shopt -u nullglob
          echo "deleted_count=$DELETED_COUNT" >> $GITHUB_OUTPUT
      - name: Commit & Push Hasil Pembersihan (jika ada)
        if: steps.cleanup_step.outputs.deleted_count != '0'
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git commit -m "chore(cleanup): Hapus ${{ steps.cleanup_step.outputs.deleted_count }} gambar orphan .webp"
          git pull origin main --rebase
          git push
      - name: No Orphan Found
        if: steps.cleanup_step.outputs.deleted_count == '0'
        run: echo "âœ… Tidak ada gambar orphan ditemukan."
  reporting:
    needs: cleanup
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Setup Variables
        id: vars
        run: |
          TARGETS="artikel img"
          DATE=$(date +'%m-%d')
          REPORT="mini/${DATE}-laporan_konten.txt"
          echo "report_path=$REPORT" >> $GITHUB_OUTPUT
          echo "targets=$TARGETS" >> $GITHUB_OUTPUT
          echo "date=$DATE" >> $GITHUB_OUTPUT
      - name: Count Files by Extension
        id: counts
        run: |
          TARGETS="${{ steps.vars.outputs.targets }}"
          declare -A counts
          for ext in html webp png; do
            counts[$ext]=$(find $TARGETS -maxdepth 1 -type f -iname "*.$ext" | wc -l)
          done
          counts[all]=$(find $TARGETS -maxdepth 1 -type f | wc -l)
          for key in "${!counts[@]}"; do
            echo "$key=${counts[$key]}" >> $GITHUB_OUTPUT
          done
      - name: Generate Report
        run: |
          REPORT="${{ steps.vars.outputs.report_path }}"
          DATE="${{ steps.vars.outputs.date }}"
          TARGETS="${{ steps.vars.outputs.targets }}"
          PREFIX_ARTIKEL="https://dalam.web.id/artikel/"
          mkdir -p "$(dirname "$REPORT")"
          {
            echo "LAPORAN KONTEN: artikel & img ($DATE)"
            echo "================================="
            echo "Total File: ${{ steps.counts.outputs.all }}"
            echo "HTML=${{ steps.counts.outputs.html }}, webp=${{ steps.counts.outputs.webp }}, PNG=${{ steps.counts.outputs.png }}"
            echo ""
            echo "Ringkasan per ekstensi:"
            find $TARGETS -maxdepth 1 -type f -print | sed 's/.*\.//' | sort | uniq -c | sort -nr
            echo ""
            echo "URL File HTML:"
            find artikel -maxdepth 1 -type f -iname "*.html" | sed "s|^artikel/|$PREFIX_ARTIKEL|g" | sort
          } > "$REPORT"
          cat "$REPORT"
      - name: Install jq
        run: sudo apt-get update && sudo apt-get install -y jq
      - name: Buat Badge JSON
        run: |
          mkdir -p mini
          html=${{ steps.counts.outputs.html }}
          webp=${{ steps.counts.outputs.webp }}
          color=$(if (( html > webp )); then echo red; elif (( html < webp )); then echo green; else echo blue; fi)
          jq -n --arg m "$html" '{schemaVersion:1,label:"artikel",message:$m,color:"blue"}' > mini/html_count_badge.json
          jq -n --arg m "$webp" '{schemaVersion:1,label:"cover",message:$m,color:"green"}' > mini/webp_count_badge.json
          jq -n --arg mh "$html" --arg mj "$webp" --arg c "$color" '{schemaVersion:1,label:"html/webp",message:("\($mh) / \($mj)"),color:$c}' > mini/html_webp_badge.json
      - name: Rotate Reports
        run: |
          mkdir -p mini
          mapfile -t files < <(ls -1t mini/*-laporan_*.txt 2>/dev/null)
          if ((${#files[@]} > 7)); then
            printf '%s\n' "${files[@]:7}" | xargs rm -f
          fi
      - name: Commit, Pull, and Push Changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email '41898282+github-actions[bot]@users.noreply.github.com'
          git add mini/*
          if ! git diff --staged --quiet; then
            git commit -m "chore: update laporan & badge konten" --author="frijal &lt;5477182+frijal@users.noreply.github.com&gt;"
            git pull origin main --rebase
            git push
          else
            echo "âœ… Tidak ada perubahan baru untuk di-commit."
          fi</code></pre>
  <div id="pesbukdiskus"></div>
  </main>
  <footer>
    ğŸ„¯ 2025 <a href="https://dalam.web.id" target="_blank">Frijal</a> â€” Jaga Data Pribadi Tetap Aman.
    <br>Artikel ini dibuat otomatis dan diperbarui dengan workflow harian.
  </footer>
  <script>
    // animasi kecil header
    document.addEventListener("DOMContentLoaded", () => {
      const h = document.querySelector("header h1");
      h.style.transition = "transform 1s";
      h.style.transform = "scale(1.1)";
      setTimeout(() => h.style.transform = "scale(1)", 1000);
    });
  </script>
<div class="search-floating-container"><input type="text" id="floatingSearchInput" placeholder="cari artikel..." autocomplete="off"><span id="floatingSearchClear" class="clear-button"></span><div id="floatingSearchResults" class="floating-results-container"></div></div>
<section id="related-marquee-section"><div id="related-marquee-container"></div></section><script defer src="/ext/marquee-url.js"></script>
<script defer src="/ext/iposbrowser.js"></script><script defer src="/ext/markdown.js"></script><script defer src="/ext/pesbukdiskus.js"></script>
</body>
</html>